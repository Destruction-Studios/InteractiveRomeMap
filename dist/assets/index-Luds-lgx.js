(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const l=document.getElementById("map"),M=document.getElementById("map-contents"),y=document.getElementById("tooltip"),g=.15;let q=0,D=0,m=!1,E=0,w=0,f=0,p=0,u=0,h=0,Y=1,a=1;const F=.8,R=5.5,Q=.001;let T=0,b=null,k=null,_=0,L=0,x=0,$=0,O=0;const C=.25;let V=[];const v=(t,e,o)=>t+(e-t)*o;l.addEventListener("mousedown",t=>{m=!0,E=t.clientX-f,w=t.clientY-p});document.addEventListener("mousemove",t=>{q=t.clientX,D=t.clientY,m&&(u=t.clientX-E,h=t.clientY-w)});document.addEventListener("mouseup",()=>{m=!1});l.addEventListener("wheel",t=>{t.preventDefault();const e=Math.exp(-t.deltaY*Q),o=Math.min(R,Math.max(F,a*e)),i=l.createSVGPoint();i.x=t.clientX,i.y=t.clientY;const n=i.matrixTransform(l.getScreenCTM().inverse());u=n.x-(n.x-u)*(o/a),h=n.y-(n.y-h)*(o/a),a=o},{passive:!1});l.addEventListener("touchstart",t=>{console.log(t.touches),t.touches.length===1?(m=!0,E=t.touches[0].clientX-f,w=t.touches[0].clientY-p):t.touches.length===2&&(T=Math.hypot(t.touches[0].clientX-t.touches[1].clientX,t.touches[0].clientY-t.touches[1].clientY))});l.addEventListener("touchmove",t=>{if(t.preventDefault(),t.touches.length===1&&m)u=t.touches[0].clientX-E,h=t.touches[0].clientY-w;else if(t.touches.length===2){const e=t.touches[0].clientX-t.touches[1].clientX,o=t.touches[0].clientY-t.touches[1].clientY,i=Math.hypot(e,o),n=i/T,s=Math.min(R,Math.max(F,a*n)),r=(t.touches[0].clientX+t.touches[1].clientX)/2,S=(t.touches[0].clientY+t.touches[1].clientY)/2,c=l.createSVGPoint();c.x=r,c.y=S;const d=c.matrixTransform(l.getScreenCTM().inverse());u=d.x-(d.x-u)*(s/a),h=d.y-(d.y-h)*(s/a),a=s,T=i}},{passive:!1});l.addEventListener("touchend",t=>{t.touches.length===1?m=!1:t.touches.length===2&&(E=t.touches[0].clientX-f,w=t.touches[0].clientY-p,m=!0)});function tt(){document.querySelectorAll(".map-tooltip").forEach(e=>{const o=e.dataset.location,i=e.dataset.tooltip||o;e.addEventListener("mouseenter",n=>{b=o,k=i,L=n.clientX+12,x=n.clientY+12}),e.addEventListener("mouseleave",n=>{b==o&&(b=null)})})}function et(){return fetch("/assets/map.txt").then(t=>t.text()).then(t=>{M.innerHTML=t})}function nt(){return fetch("/map_pins.json").then(t=>t.json()).then(t=>{const e=l.viewBox.baseVal,o=e.width,i=e.height;for(const[n,s]of Object.entries(t)){const r=s.x/100*o,S=s.y/100*i,c=document.createElementNS("http://www.w3.org/2000/svg","use"),d=24*C,I=32*C;c.setAttribute("href","#map-pin"),c.setAttribute("x",r-d/2),c.setAttribute("y",S-I),c.setAttribute("width",d),c.setAttribute("height",I),c.dataset.location=n,c.dataset.tooltip=s.tooltip||"no tooltip",c.classList.add("map-pin"),c.classList.add("map-location"),c.classList.add("map-tooltip"),M.append(c),V.push({element:c,zoom:s.zoom,visible:!0})}})}function ot(){for(const t of V)t.zoom!=null&&(a>=t.zoom?!t.visible&&(t.element.style.opacity="1",t.visible=!0,t.element.style.pointerEvents=""):t.visible&&(t.element.style.opacity="0",t.visible=!1,t.element.style.pointerEvents="none"))}function st(){document.querySelectorAll(".map-location").forEach(e=>{const o=e.dataset.location;e.addEventListener("mousedown",()=>{window.location.hash=`${o.toLowerCase()}`})})}function G(){f=v(f,u,g),p=v(p,h,g),L=v(L,$,g),x=v(x,O,g),Y=v(Y,a,g),M.setAttribute("transform",`translate(${f}, ${p}) scale(${Y})`);const t=performance.now();O=D-24,$=q+12,b==null?t-_>75&&(y.style.display="none"):(_=t,y.style.display="",y.innerText=k,y.style.left=`${L}px`,y.style.top=`${x}px`),ot(),requestAnimationFrame(G)}location.hostname==="localhost"&&l.addEventListener("click",t=>{const e=l.createSVGPoint();e.x=t.clientX,e.y=t.clientY;const o=e.matrixTransform(M.getCTM().inverse()),i=l.viewBox.baseVal,n=o.x/i.width*100,s=o.y/i.height*100;console.log(`"x": ${n.toFixed(2)}, "y": ${s.toFixed(2)}`)});const it=et().then(nt).then(tt).then(st).finally(G),z=document.getElementById("sidebar"),ct=document.getElementById("sidebar-resizer"),lt=document.getElementById("sidebar-header"),at=document.getElementById("sidebar-content"),B=document.getElementById("sidebar-back"),A="home",rt=175,dt=500;let W="home",Z=!0,X=!1,P={};const K=[],U=[];ct.addEventListener("mousedown",()=>{X=!0,document.body.style.cursor="ew-resize",document.body.style.userSelect="none"});document.addEventListener("mousemove",t=>{if(!X)return;const e=t.clientX-z.getBoundingClientRect().left;e>=rt&&e<=dt&&(z.style.width=`${e}px`)});document.addEventListener("mouseup",()=>{X&&(X=!1,document.body.style.cursor="",document.body.style.userSelect="")});function ut(){return fetch("/map_pins.json").then(t=>t.json()).then(async t=>{for(const e in t){const o=t[e];U.push({name:o.tooltip,hash:e})}})}function ht(){return fetch("/sidebar_profiles/tabs.json").then(t=>t.json()).then(async t=>{for(const e in t){const o=t[e],i=`/sidebar_profiles/${e}.html`,s=await(await fetch(i)).text();P[e]={header:o.header,contents:s},K.push({name:o.header,hash:e})}})}function H(){const t=window.location.hash.replace("#","");if(console.log(`Hash changed: ${t}`),!t){N(A);return}N(t.toLowerCase())}function j(t){const e=document.createElement("li"),o=document.createElement("a");return o.textContent=t.name,o.href=`#${t.hash}`,o.classList.add("no-underline"),e.append(o),e}function N(t){console.log(`Setting tab: ${t}`);let e=P[t];if(e==null&&(e=P._error),W=t,lt.innerText=e.header,at.innerHTML=e.contents,t==="home"){const o=document.getElementById("location-list"),i=document.getElementById("place-list");K.forEach(n=>{n.hash[0]==="_"||n.hash==="home"||o.append(j(n))}),U.forEach(n=>{i.append(j(n))})}}function J(){let t=!0;W===A&&(t=!1),t!=Z&&(Z=t,B.style.opacity=t?"1":"0",B.style.pointerEvents=t?"auto":"none"),requestAnimationFrame(J)}async function mt(){await ht(),await ut(),H(),B.addEventListener("mousedown",()=>{window.location.hash=A}),window.addEventListener("hashchange",H),J()}const ft=document.querySelectorAll(".linkable-text");ft.forEach(t=>{const e=t.dataset.url;t.addEventListener("click",()=>{window.open(e,"_blank")})});console.log("Awaiting map...");await it;console.log("Map ready!");await mt();console.log("Sidebar loaded");
