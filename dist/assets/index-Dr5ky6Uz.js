(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}})();const l=document.getElementById("map"),E=document.getElementById("map-contents"),d=document.getElementById("tooltip"),u=.15;let z=0,H=0,M=!1,Z=0,N=0,f=0,p=0,b=0,w=0,L=1,r=1;const V=.8,W=5.5,G=.001;let h=null,q=null,X=0,y=0,g=0,I=0,P=0;const Y=.25;let F=[];const m=(e,t,o)=>e+(t-e)*o;l.addEventListener("mousedown",e=>{M=!0,Z=e.clientX-f,N=e.clientY-p});document.addEventListener("mousemove",e=>{z=e.clientX,H=e.clientY,M&&(b=e.clientX-Z,w=e.clientY-N)});document.addEventListener("mouseup",()=>{M=!1});l.addEventListener("wheel",e=>{e.preventDefault();const t=Math.exp(-e.deltaY*G),o=Math.min(W,Math.max(V,r*t)),i=l.createSVGPoint();i.x=e.clientX,i.y=e.clientY;const n=i.matrixTransform(l.getScreenCTM().inverse());b=n.x-(n.x-b)*(o/r),w=n.y-(n.y-w)*(o/r),r=o},{passive:!1});function K(){document.querySelectorAll(".map-tooltip").forEach(t=>{const o=t.dataset.location,i=t.dataset.tooltip||o;t.addEventListener("mouseenter",n=>{h=o,q=i,y=n.clientX+12,g=n.clientY+12}),t.addEventListener("mouseleave",n=>{h==o&&(h=null)})})}function U(){return fetch("/assets/map.txt").then(e=>e.text()).then(e=>{E.innerHTML=e})}function J(){return fetch("/map_pins.json").then(e=>e.json()).then(e=>{const t=l.viewBox.baseVal,o=t.width,i=t.height;for(const[n,s]of Object.entries(e)){const c=s.x/100*o,D=s.y/100*i,a=document.createElementNS("http://www.w3.org/2000/svg","use"),A=24*Y,B=32*Y;a.setAttribute("href","#map-pin"),a.setAttribute("x",c-A/2),a.setAttribute("y",D-B),a.setAttribute("width",A),a.setAttribute("height",B),a.dataset.location=n,a.dataset.tooltip=s.tooltip||"no tooltip",a.classList.add("map-pin"),a.classList.add("map-location"),a.classList.add("map-tooltip"),E.append(a),F.push({element:a,zoom:s.zoom,visible:!0})}})}function Q(){for(const e of F)e.zoom!=null&&(r>=e.zoom?!e.visible&&(e.element.style.opacity="1",e.visible=!0):e.visible&&(e.element.style.opacity="0",e.visible=!1))}function R(){f=m(f,b,u),p=m(p,w,u),y=m(y,I,u),g=m(g,P,u),L=m(L,r,u),E.setAttribute("transform",`translate(${f}, ${p}) scale(${L})`);const e=performance.now();P=H-24,I=z+12,h==null?e-X>75&&(d.style.display="none"):(X=e,d.style.display="",d.innerText=q,d.style.left=`${y}px`,d.style.top=`${g}px`),Q(),requestAnimationFrame(R)}location.hostname==="localhost"&&l.addEventListener("click",e=>{const t=l.createSVGPoint();t.x=e.clientX,t.y=e.clientY;const o=t.matrixTransform(E.getCTM().inverse()),i=l.viewBox.baseVal,n=o.x/i.width*100,s=o.y/i.height*100;console.log(`"x": ${n.toFixed(2)}, "y": ${s.toFixed(2)}`)});const ee=U().then(J).then(K).finally(R),O=document.getElementById("sidebar"),te=document.getElementById("sidebar-resizer"),ne=document.getElementById("sidebar-header"),oe=document.getElementById("sidebar-content"),x=document.getElementById("sidebar-back"),T="home",se=175,ie=500;let j="home",$=!0,v=!1,S={};te.addEventListener("mousedown",()=>{v=!0,document.body.style.cursor="ew-resize",document.body.style.userSelect="none"});document.addEventListener("mousemove",e=>{if(!v)return;const t=e.clientX-O.getBoundingClientRect().left;t>=se&&t<=ie&&(O.style.width=`${t}px`)});document.addEventListener("mouseup",()=>{v&&(v=!1,document.body.style.cursor="",document.body.style.userSelect="")});function ae(){return fetch("/sidebar_profiles/tabs.json").then(e=>e.json()).then(async e=>{for(const t in e){const o=e[t],i=`/sidebar_profiles/${t}.html`,s=await(await fetch(i)).text();S[t]={header:o.header,contents:s}}})}function _(){const e=window.location.hash.replace("#","");if(console.log(`Hash changed: ${e}`),!e){C(T);return}C(e.toLowerCase())}function le(){const e=document.querySelectorAll(".map-location");console.log(e),e.forEach(t=>{const o=t.dataset.location;t.addEventListener("mousedown",()=>{window.location.hash=`${o.toLowerCase()}`})})}function C(e){console.log(`Setting tab: ${e}`);let t=S[e];t==null&&(t=S.error),j=e,ne.innerText=t.header,oe.innerHTML=t.contents}function k(){let e=!0;j===T&&(e=!1),e!=$&&($=e,x.style.opacity=e?"1":"0",x.style.pointerEvents=e?"auto":"none"),requestAnimationFrame(k)}async function re(){await ae(),le(),_(),x.addEventListener("mousedown",()=>{window.location.hash=T}),window.addEventListener("hashchange",_),k()}const ce=document.querySelectorAll(".linkable-text");ce.forEach(e=>{const t=e.dataset.url;e.addEventListener("click",()=>{window.open(t,"_blank")})});console.log("Awaiting map...");await ee;console.log("Map ready!");await re();console.log("Sidebar loaded");
